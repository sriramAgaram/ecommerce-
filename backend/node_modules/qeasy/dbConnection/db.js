const mysql = require("mysql2/promise");

/** @type {import('mysql2/promise').Pool} */
let pool;

exports.connectDB = ({ host = 'localhost', user, password, database, port = 3306 }) => {
    pool = mysql.createPool({
        port,
        host,
        user,
        password,
        database,
        waitForConnections: true,
        connectionLimit: 10,
        queueLimit: 0,
    });

    console.log("QEasy connected");
    return pool;
};

exports.checkConnection = () => {
    if (!pool) throw new Error("QEasy: Database not connected. Call connectDB() first.");
    return pool;
};
